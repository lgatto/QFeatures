<!-- Generated by pkgdown: do not edit by hand -->
<!DOCTYPE html>
<html lang="en">
  <head>
  <meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1.0">

<title>Join assays in a QFeatures object — joinAssays • QFeatures</title>


<!-- jquery -->
<script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.4.1/jquery.min.js" integrity="sha256-CSXorXvZcTkaix6Yvo6HppcZGetbYMGWSFlBw8HfCJo=" crossorigin="anonymous"></script>
<!-- Bootstrap -->

<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/css/bootstrap.min.css" integrity="sha256-bZLfwXAP04zRMK2BjiO8iu9pf4FbLqX6zitd+tIvLhE=" crossorigin="anonymous" />

<script src="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/js/bootstrap.min.js" integrity="sha256-nuL8/2cJ5NDSSwnKD8VqreErSWHtnEP9E7AySL+1ev4=" crossorigin="anonymous"></script>

<!-- bootstrap-toc -->
<link rel="stylesheet" href="../bootstrap-toc.css">
<script src="../bootstrap-toc.js"></script>

<!-- Font Awesome icons -->
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/all.min.css" integrity="sha256-mmgLkCYLUQbXn0B1SRqzHar6dCnv9oZFPEC1g1cwlkk=" crossorigin="anonymous" />
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/v4-shims.min.css" integrity="sha256-wZjR52fzng1pJHwx4aV2AO3yyTOXrcDW7jBpJtTwVxw=" crossorigin="anonymous" />

<!-- clipboard.js -->
<script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.6/clipboard.min.js" integrity="sha256-inc5kl9MA1hkeYUt+EC3BhlIgyp/2jDIyBLS6k3UxPI=" crossorigin="anonymous"></script>

<!-- headroom.js -->
<script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/headroom.min.js" integrity="sha256-AsUX4SJE1+yuDu5+mAVzJbuYNPHj/WroHuZ8Ir/CkE0=" crossorigin="anonymous"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/jQuery.headroom.min.js" integrity="sha256-ZX/yNShbjqsohH1k95liqY9Gd8uOiE1S4vZc+9KQ1K4=" crossorigin="anonymous"></script>

<!-- pkgdown -->
<link href="../pkgdown.css" rel="stylesheet">
<script src="../pkgdown.js"></script>




<meta property="og:title" content="Join assays in a QFeatures object — joinAssays" />
<meta property="og:description" content="This function applies a full-join type of operation on 2 or more
assays in a QFeatures instance." />






<!-- mathjax -->
<script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha256-nvJJv9wWKEm88qvoQl9ekL2J+k/RWIsaSScxxlsrv8k=" crossorigin="anonymous"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/config/TeX-AMS-MML_HTMLorMML.js" integrity="sha256-84DKXVJXs0/F8OTMzX4UR909+jtl4G7SPypPavF+GfA=" crossorigin="anonymous"></script>

<!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]-->



  </head>

  <body data-spy="scroll" data-target="#toc">
    <div class="container template-reference-topic">
      <header>
      <div class="navbar navbar-default navbar-fixed-top" role="navigation">
  <div class="container">
    <div class="navbar-header">
      <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar" aria-expanded="false">
        <span class="sr-only">Toggle navigation</span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      <span class="navbar-brand">
        <a class="navbar-link" href="../index.html">QFeatures</a>
        <span class="version label label-default" data-toggle="tooltip" data-placement="bottom" title="Released version">1.1.2</span>
      </span>
    </div>

    <div id="navbar" class="navbar-collapse collapse">
      <ul class="nav navbar-nav">
        <li>
  <a href="../articles/QFeatures.html">Get started</a>
</li>
<li>
  <a href="../reference/index.html">Reference</a>
</li>
<li class="dropdown">
  <a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" aria-expanded="false">
    Articles
     
    <span class="caret"></span>
  </a>
  <ul class="dropdown-menu" role="menu">
    <li>
      <a href="../articles/Processing.html">Processing quantitative proteomics data with QFeatures</a>
    </li>
  </ul>
</li>
<li>
  <a href="../news/index.html">Changelog</a>
</li>
      </ul>
      <ul class="nav navbar-nav navbar-right">
        <li>
  <a href="https://github.com/RforMassSpectrometry/QFeatures/">
    <span class="fab fa-github fa-lg"></span>
     
  </a>
</li>
      </ul>
      
    </div><!--/.nav-collapse -->
  </div><!--/.container -->
</div><!--/.navbar -->

      

      </header>

<div class="row">
  <div class="col-md-9 contents">
    <div class="page-header">
    <h1>Join assays in a QFeatures object</h1>
    <small class="dont-index">Source: <a href='https://github.com/RforMassSpectrometry/QFeatures/blob/master/R/QFeatures-join.R'><code>R/QFeatures-join.R</code></a></small>
    <div class="hidden name"><code>joinAssays.Rd</code></div>
    </div>

    <div class="ref-description">
    <p>This function applies a full-join type of operation on 2 or more
assays in a <code>QFeatures</code> instance.</p>
    </div>

    <pre class="usage"><span class='fu'>joinAssays</span><span class='op'>(</span><span class='va'>x</span>, <span class='va'>i</span>, name <span class='op'>=</span> <span class='st'>"joinedAssay"</span><span class='op'>)</span></pre>

    <h2 class="hasAnchor" id="arguments"><a class="anchor" href="#arguments"></a>Arguments</h2>
    <table class="ref-arguments">
    <colgroup><col class="name" /><col class="desc" /></colgroup>
    <tr>
      <th>x</th>
      <td><p>An instance of class <a href='QFeatures.html'>QFeatures</a>.</p></td>
    </tr>
    <tr>
      <th>i</th>
      <td><p>The indices or names of al least two assays to be joined.</p></td>
    </tr>
    <tr>
      <th>name</th>
      <td><p>A <code><a href='https://rdrr.io/r/base/character.html'>character(1)</a></code> naming the new assay. Default is
<code>joinedAssay</code>. Note that the function will fail if there's
already an assay with <code>name</code>.</p></td>
    </tr>
    </table>

    <h2 class="hasAnchor" id="value"><a class="anchor" href="#value"></a>Value</h2>

    <p>A <code>QFeatures</code> object with an additional assay.</p>
    <h2 class="hasAnchor" id="details"><a class="anchor" href="#details"></a>Details</h2>

    <p>The rows to be joined are chosen based on the rownames of the
respective assays. It is the user's responsability to make sure
these are meaningful, such as for example refering to unique
peptide sequences or proteins.</p>
<p>The join operation acts along the rows and expects the samples
(columns) of the assays to be disjoint, i.e. the assays mustn't
share any samples. Rows that aren't present in an assay are set to
<code>NA</code> when merged.</p>
<p>The <code>rowData</code> slots are also joined. However, only columns that
are shared and that have the same values for matching columns/rows
are retained. For example of a feature variable <code>A</code> in sample <code>S1</code>
contains value <code>a1</code> and variable <code>A</code> in sample <code>S2</code> in a different
assay contains <code>a2</code>, then the feature variable <code>A</code> is dropped in
the merged assay.</p>
<p>The joined assay is linked to its parent assays through an <code>AssayLink</code>
object. The link between the child assay and the parent assays is based on
the assay row names, just like the procedure for joining the parent assays.</p>
    <h2 class="hasAnchor" id="author"><a class="anchor" href="#author"></a>Author</h2>

    <p>Laurent Gatto</p>

    <h2 class="hasAnchor" id="examples"><a class="anchor" href="#examples"></a>Examples</h2>
    <pre class="examples"><div class='input'>
<span class='co'>## -----------------------------------------------</span>
<span class='co'>## An example QFeatures with 3 assays to be joined</span>
<span class='co'>## -----------------------------------------------</span>
<span class='fu'><a href='https://rdrr.io/r/utils/data.html'>data</a></span><span class='op'>(</span><span class='va'>feat2</span><span class='op'>)</span>
<span class='va'>feat2</span>
</div><div class='output co'>#&gt; An instance of class QFeatures containing 3 assays:
#&gt;  [1] assay1: SummarizedExperiment with 10 rows and 4 columns 
#&gt;  [2] assay2: SummarizedExperiment with 4 rows and 4 columns 
#&gt;  [3] assay3: SummarizedExperiment with 7 rows and 4 columns </div><div class='input'>
<span class='va'>feat2</span> <span class='op'>&lt;-</span> <span class='fu'>joinAssays</span><span class='op'>(</span><span class='va'>feat2</span>, <span class='fl'>1</span><span class='op'>:</span><span class='fl'>3</span><span class='op'>)</span>

<span class='co'>## Individual assays to be joined, each with 4 samples and a</span>
<span class='co'>## variable number of rows.</span>
<span class='fu'>assay</span><span class='op'>(</span><span class='va'>feat2</span><span class='op'>[[</span><span class='fl'>1</span><span class='op'>]</span><span class='op'>]</span><span class='op'>)</span>
</div><div class='output co'>#&gt;   S1 S2 S3 S4
#&gt; a  1 11 21 31
#&gt; b  2 12 22 32
#&gt; c  3 13 23 33
#&gt; d  4 14 24 34
#&gt; e  5 15 25 35
#&gt; f  6 16 26 36
#&gt; g  7 17 27 37
#&gt; h  8 18 28 38
#&gt; i  9 19 29 39
#&gt; j 10 20 30 40</div><div class='input'><span class='fu'>assay</span><span class='op'>(</span><span class='va'>feat2</span><span class='op'>[[</span><span class='fl'>2</span><span class='op'>]</span><span class='op'>]</span><span class='op'>)</span>
</div><div class='output co'>#&gt;   S5 S6 S7 S8
#&gt; h  1  5  9 13
#&gt; i  2  6 10 14
#&gt; j  3  7 11 15
#&gt; k  4  8 12 16</div><div class='input'><span class='fu'>assay</span><span class='op'>(</span><span class='va'>feat2</span><span class='op'>[[</span><span class='fl'>3</span><span class='op'>]</span><span class='op'>]</span><span class='op'>)</span>
</div><div class='output co'>#&gt;   S9 S10 S11 S12
#&gt; a  1   8  15  22
#&gt; b  2   9  16  23
#&gt; j  3  10  17  24
#&gt; k  4  11  18  25
#&gt; l  5  12  19  26
#&gt; m  6  13  20  27
#&gt; n  7  14  21  28</div><div class='input'>
<span class='co'>## The joined assay contains 14 rows (corresponding to the union</span>
<span class='co'>## of those in the initial assays) and 12 samples</span>
<span class='fu'>assay</span><span class='op'>(</span><span class='va'>feat2</span><span class='op'>[[</span><span class='st'>"joinedAssay"</span><span class='op'>]</span><span class='op'>]</span><span class='op'>)</span>
</div><div class='output co'>#&gt;   S1 S2 S3 S4 S5 S6 S7 S8 S9 S10 S11 S12
#&gt; j 10 20 30 40  3  7 11 15  3  10  17  24
#&gt; a  1 11 21 31 NA NA NA NA  1   8  15  22
#&gt; b  2 12 22 32 NA NA NA NA  2   9  16  23
#&gt; k NA NA NA NA  4  8 12 16  4  11  18  25
#&gt; h  8 18 28 38  1  5  9 13 NA  NA  NA  NA
#&gt; i  9 19 29 39  2  6 10 14 NA  NA  NA  NA
#&gt; d  4 14 24 34 NA NA NA NA NA  NA  NA  NA
#&gt; e  5 15 25 35 NA NA NA NA NA  NA  NA  NA
#&gt; f  6 16 26 36 NA NA NA NA NA  NA  NA  NA
#&gt; c  3 13 23 33 NA NA NA NA NA  NA  NA  NA
#&gt; g  7 17 27 37 NA NA NA NA NA  NA  NA  NA
#&gt; l NA NA NA NA NA NA NA NA  5  12  19  26
#&gt; m NA NA NA NA NA NA NA NA  6  13  20  27
#&gt; n NA NA NA NA NA NA NA NA  7  14  21  28</div><div class='input'>
<span class='co'>## The individual rowData to be joined.</span>
<span class='fu'>rowData</span><span class='op'>(</span><span class='va'>feat2</span><span class='op'>[[</span><span class='fl'>1</span><span class='op'>]</span><span class='op'>]</span><span class='op'>)</span>
</div><div class='output co'>#&gt; DataFrame with 10 rows and 2 columns
#&gt;          Prot         x
#&gt;   &lt;character&gt; &lt;numeric&gt;
#&gt; a          Pa  2.067646
#&gt; b          Pb -0.188981
#&gt; c          Pc  0.266870
#&gt; d          Pd  1.671331
#&gt; e          Pe -1.857170
#&gt; f          Pf  1.166811
#&gt; g          Pg  0.316521
#&gt; h          Ph  0.976154
#&gt; i          Pi  0.117673
#&gt; j          Pj  2.420734</div><div class='input'><span class='fu'>rowData</span><span class='op'>(</span><span class='va'>feat2</span><span class='op'>[[</span><span class='fl'>2</span><span class='op'>]</span><span class='op'>]</span><span class='op'>)</span>
</div><div class='output co'>#&gt; DataFrame with 4 rows and 3 columns
#&gt;          Prot          x         y
#&gt;   &lt;character&gt;  &lt;numeric&gt; &lt;numeric&gt;
#&gt; h          Ph -0.0463617  1.547125
#&gt; i          Pi  0.6833728 -1.513248
#&gt; j          Pj  0.7917619  0.574492
#&gt; k          Pk -0.5226943  1.404666</div><div class='input'><span class='fu'>rowData</span><span class='op'>(</span><span class='va'>feat2</span><span class='op'>[[</span><span class='fl'>3</span><span class='op'>]</span><span class='op'>]</span><span class='op'>)</span>
</div><div class='output co'>#&gt; DataFrame with 7 rows and 3 columns
#&gt;          Prot          x         y
#&gt;   &lt;character&gt;  &lt;numeric&gt; &lt;numeric&gt;
#&gt; a          Pa -0.0762406 -0.420478
#&gt; b          Pb  0.5580027 -0.389534
#&gt; j          Pj  2.5905327 -0.377114
#&gt; k          Pk  0.1605870 -0.418806
#&gt; l          Pl  0.7486858  1.967733
#&gt; m          Pm  1.2365642 -0.516798
#&gt; n          Pn -0.4848651  0.263387</div><div class='input'>
<span class='co'>## Only the 'Prot' variable is retained because it is shared among</span>
<span class='co'>## all assays and the values and coherent across samples (the</span>
<span class='co'>## value of 'Prot' for row 'j' is always 'Pj'). The variable 'y' is</span>
<span class='co'>## missing in 'assay1' and while variable 'x' is present is all</span>
<span class='co'>## assays, the values for the shared rows are different.</span>
<span class='fu'>rowData</span><span class='op'>(</span><span class='va'>feat2</span><span class='op'>[[</span><span class='st'>"joinedAssay"</span><span class='op'>]</span><span class='op'>]</span><span class='op'>)</span>
</div><div class='output co'>#&gt; DataFrame with 14 rows and 1 column
#&gt;            Prot
#&gt;     &lt;character&gt;
#&gt; j            Pj
#&gt; a            Pa
#&gt; b            Pb
#&gt; k            Pk
#&gt; h            Ph
#&gt; ...         ...
#&gt; c            Pc
#&gt; g            Pg
#&gt; l            Pl
#&gt; m            Pm
#&gt; n            Pn</div></pre>
  </div>
  <div class="col-md-3 hidden-xs hidden-sm" id="pkgdown-sidebar">
    <nav id="toc" data-toggle="toc" class="sticky-top">
      <h2 data-toc-skip>Contents</h2>
    </nav>
  </div>
</div>


      <footer>
      <div class="copyright">
  <p>Developed by Laurent Gatto, Christophe Vanderaa.</p>
</div>

<div class="pkgdown">
  <p>Site built with <a href="https://pkgdown.r-lib.org/">pkgdown</a> 1.6.1.9000.</p>
</div>

      </footer>
   </div>

  


  </body>
</html>


